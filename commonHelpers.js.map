{"version":3,"file":"commonHelpers.js","sources":["../src/js/shoppinglist.js","../src/card.js"],"sourcesContent":["import { renderTitle } from '../js/Services/helpers';\nimport localStorageBooks from '../js/localstorage';\n(function () {\n  const shoppingList = document.querySelector('.cart-list');\n  const cartEmptyMsg = document.querySelector('.cart-empty-container');\n  const paginationList = document.querySelector('.pagination-list');\n\n  renderTitle('.shoppinglist-title', 'Shopping List');\n  function renderShoppingList(books) {\n    shoppingList.innerHTML = '';\n    const hmtlBookList = books\n      .map(book => {\n        return `<li class=\"cart-item\">\n      <img\n        class=\"cart-item-img\"\n        src=\"${book.book_image}\"\n        alt=\"book image\"\n        width=\"100\"\n        height=\"142\"\n      />\n      <div class=\"cart-item-content\">\n        <div class=\"cart-item-content-top\">\n          <div class=\"cart-item-content-top-left\">\n            <h3 class=\"cart-item-title\">${book.title}</h3>\n            <p class=\"cart-item-category\">${book.list_name}</p>\n          </div>\n          <button data-id=\"${book._id}\" class=\"cart-item-del-button\">\n            <svg class=\"cart-item-del-button-icon\" width=\"12\" height=\"12\">\n              <use href=\"../img/symbol-defs.svg#icon-delete-shoppinglist-tab\" />\n            </svg>\n          </button>\n        </div>\n        <div class=\"cart-item-content-middle\">\n          <p class=\"cart-item-content-desc\">\n            ${book.description}\n          </p>\n          <div class=\"cart-item-content-bottom\">\n            <p class=\"cart-item-author\">${book.author}</p>\n            <div class=\"cart-items-links\">\n              <a\n                class=\"cart-items-link\"\n                target=\"_blank\"\n                href=\"${book.amazon_buy_link}\"\n              >\n                <svg class=\"cart-item-amazon\" width=\"32\" height=\"11\">\n                  <use href=\"../img/symbol-defs.svg#icon-amazon\" />\n                </svg>\n              </a>\n              <a\n                class=\"cart-items-link\"\n                target=\"_blank\"\n                href=\"${book.apple_buy_link}\"\n              >\n                <svg class=\"cart-items-apple\" width=\"16\" height=\"16\">\n                  <use href=\"../img/symbol-defs.svg#icon-applebook\" />\n                </svg>\n              </a>\n            </div>\n          </div>\n        </div>\n      </div>\n    </li>`;\n      })\n      .join('');\n    shoppingList.insertAdjacentHTML('beforeend', hmtlBookList);\n  }\n\n  let pageData = {\n    books: [],\n    currentPage: 1,\n    nextPage: 0,\n    prevPage: 0,\n    totalBooks: 0,\n    totalPages: 0,\n    booksPerPage: 0,\n  };\n\n  function renderShoppingListPage(pageData) {\n    paginationList.removeEventListener('click', buttonClickHandler);\n    shoppingList.removeEventListener('click', removeBookFromList);\n    const books = localStorageBooks.getAllBooks();\n    console.log(shoppingList);\n    shoppingList.innerHTML = '';\n    paginationList.innerHTML = '';\n    pageData.totalBooks = books.length;\n    pageData.booksPerPage = getBooksPerPage();\n    pageData.totalPages = getTotalPages(\n      pageData.totalBooks,\n      pageData.booksPerPage\n    );\n    pageData.books = createBooksListsPerPage(\n      books,\n      pageData.booksPerPage,\n      pageData.totalPages\n    );\n\n    console.log(pageData);\n\n    if (pageData.totalPages === 1) {\n      renderShoppingList(pageData.books[0]);\n    }\n\n    if (pageData.totalPages > 1) {\n      renderShoppingList(pageData.books[pageData.currentPage - 1]);\n      renderPaginationButtons(pageData.totalPages, paginationList);\n      makeActiveButton(pageData.currentPage);\n      paginationList.addEventListener('click', buttonClickHandler);\n    }\n    shoppingList.addEventListener('click', removeBookFromList);\n  }\n\n  function buttonClickHandler(e) {\n    const clickedElement = e.target.closest('button');\n    if (clickedElement) {\n      const pageButton = clickedElement.dataset.page;\n      if (pageButton) {\n        renderShoppingList(pageData.books[pageButton - 1]);\n        makeActiveButton(pageButton);\n        pageData.currentPage = pageButton;\n        console.log('premuto pulsante: ', pageData);\n      }\n    }\n  }\n\n  function removeBookFromList(e) {\n    if (e.target.closest('.cart-item-del-button') !== null) {\n      const bookId = e.target.closest('.cart-item-del-button').dataset.id;\n      localStorageBooks.removeBookFromFavorites(bookId);\n      console.log(\n        'dentro listener: ',\n        pageData.books[pageData.currentPage - 1]\n      );\n      console.log('current page: ', pageData.currentPage);\n      console.log('totale page:', pageData.totalPages);\n      console.log(pageData.books[pageData.currentPage - 1].length);\n      if (\n        parseInt(pageData.currentPage) === pageData.totalPages &&\n        pageData.books[pageData.currentPage - 1].length === 1\n      ) {\n        console.log('eliminato ultimo libro della pagina ');\n        pageData.currentPage -= 1;\n        console.log(pageData.currentPage);\n      }\n      renderShoppingListPage(pageData);\n    }\n  }\n  //   const pagesBook = createBooksListsPerPage(books, booksPerPage, totalPages);\n\n  //   // console.log('array for each page:', pagesBook);\n\n  //   if (totalBooks === 0) {\n  //     cartEmptyMsg.classList.remove('is-hidden');\n  //   } else {\n  //     if (totalPages > 1) {\n  //       console.log('current page: ', currentPage);\n  //       renderShoppingList(pagesBook[currentPage - 1]);\n  //       paginationButtons.addEventListener('click', buttonsHandler);\n  //       renderPaginationButtons(totalPages, paginationButtons);\n  //     }\n  //     // createCartPagination(pagesBook, paginationButtons, totalPages, currentPage);\n  //     shoppingList.addEventListener('click', remove);\n  //\n  //   }\n  // }\n\n  function getBooksPerPage() {\n    const windowWidth = window.innerWidth;\n    if (windowWidth < 767) {\n      return 4;\n    } else {\n      return 3;\n    }\n  }\n\n  function getTotalPages(totalBooks, booksPerPage) {\n    return Math.ceil(totalBooks / booksPerPage);\n  }\n\n  function renderPaginationButtons(totalPages, paginationList) {\n    paginationList.innerHTML = '';\n    if (totalPages > 1) {\n      paginationList.insertAdjacentHTML(\n        'beforeend',\n        `<button class=\"pagination-buttons-first\"><<</button>\n      <button class=\"pagination-buttons-prev\"><</button>\n      <button class=\"pagination-buttons-next\">></button>\n      <button class=\"pagination-buttons-last\">>></button>`\n      );\n\n      const prevButton = document.querySelector('.pagination-buttons-prev');\n      prevButton.insertAdjacentHTML(\n        'afterend',\n        '<ul class=\"pagination-buttons-numbers\"></ul>'\n      );\n\n      const numbersButtonsList = document.querySelector(\n        '.pagination-buttons-numbers'\n      );\n\n      for (let i = 0; i < totalPages; i++) {\n        const pageNumber = i + 1;\n        numbersButtonsList.insertAdjacentHTML(\n          'beforeend',\n          `<li><button data-page=\"${pageNumber}\">${pageNumber}</button></li>`\n        );\n      }\n    }\n  }\n\n  // function buttonsHandler(e) {\n  //   if (e.target.closest('button')) {\n  //     if (e.target.closest('button').dataset.page) {\n  //       console.log(e.target.closest('button').dataset.page);\n  //       let newCurrentPage = e.target.closest('button').dataset.page;\n  //       let currentButton = document.querySelector('.active');\n  //       if (currentButton !== null) {\n  //         currentButton.classList.remove('active');\n  //       }\n  //       makeActiveButton(newCurrentPage);\n  //       currentButton = document.querySelector('.active');\n  //       console.log(currentButton);\n  //       renderShoppingList(pagesBook[newCurrentPage - 1]);\n  //     }\n  //     // if (\n  //     //   e.target\n  //     //     .closest('button')\n  //     //     .classList.contains('pagination-buttons-prev')\n  //     // ) {\n  //     //   const currentButton = document.querySelector('.active');\n  //     //   if (currentButton !== null) {\n  //     //     const currentPage = currentButton.dataset.page;\n  //     //     console.log('pressed button prev, current page: ', currentPage);\n  //     //     if (currentPage > 1) {\n  //     //       renderShoppingList(books[currentPage - 2]);\n  //     //       currentButton.classList.remove('active');\n  //     //       console.log('prev', currentButton, books);\n  //     //       makeActiveButton(parseInt(currentPage) - 1);\n  //     //     }\n  //     //   }\n  //     // }\n  //     // if (\n  //     //   e.target\n  //     //     .closest('button')\n  //     //     .classList.contains('pagination-buttons-next')\n  //     // ) {\n  //     //   const currentButton = document.querySelector('.active');\n  //     //   if (currentButton !== null) {\n  //     //     const currentPage = currentButton.dataset.page;\n  //     //     console.log(currentPage);\n  //     //     if (currentPage < books.length) {\n  //     //       console.log('pressed button next, current page: ', currentPage);\n  //     //       renderShoppingList(books[currentPage]);\n  //     //       currentButton.classList.remove('active');\n  //     //       console.log('next', currentButton, books);\n  //     //       makeActiveButton(parseInt(currentPage) + 1);\n  //     //     }\n  //     //   }\n  //     // }\n  //   }\n  // }\n\n  function makeActiveButton(currentPage) {\n    console.log('make active button with page ', currentPage);\n    const currentButton = document.querySelector('.active');\n    currentButton?.classList.remove('active');\n    const activeButton = document.querySelector(`[data-page=\"${currentPage}\"]`);\n    activeButton.classList.add('active');\n  }\n\n  function createBooksListsPerPage(books, booksPerPage, totalPages) {\n    let booksPages = [];\n    for (let i = 0; i < totalPages; i++) {\n      booksPages[i] = books.splice(0, booksPerPage);\n    }\n    return booksPages;\n  }\n\n  // for (let i = 0; i < 20; i++) {\n  //   const book = {\n  //     _id: `${i}`,\n  //     title: `${i}`,\n  //     author: 'Michelle Zauner',\n  //     list_name: 'Paperback Nonfiction',\n  //     book_image:\n  //       'https://storage.googleapis.com/du-prd/books/images/9780525657743.jpg',\n  //     description:\n  //       'The daughter of a Korean mother and Jewish American father, and leader of the indie rock project Japanese Breakfast, describes creating her own identity after losing her mother to cancer.',\n  //     amazon_buy_link: 'https://www.amazon.com/dp/0593379853?tag=NYTBSREV-20',\n  //     apple_buy_link: 'https://goto.applebooks.apple/9781984896391?at=10lIEQ',\n  //   };\n\n  //   localStorageBooks.addBookToFavorites(book);\n  // }\n\n  renderShoppingListPage(pageData);\n\n  //   let variabileLocale = 'Valore';\n\n  //   document.getElementById('mioElemento').addEventListener('click', function () {\n  //     // Usa variabileLocale qui\n  //     console.log(variabileLocale);\n  //   });\n})();\n","import './js/shoppinglist';\nimport './js/cardpagination';\nimport './js/header';\nimport './js/support';\nimport './js/Services/api';\nimport './js/Services/helpers';\nimport './js/signup';\nimport './js/signupmarkup' \nimport './js/localstorage'\n\nwindow.addEventListener('load', () => {\n  let background = document.querySelector('.background');\n  background.classList.add('hide');\n  setTimeout(() => {\n    background.remove();\n  }, 600)\n})"],"names":["shoppingList","paginationList","renderTitle","renderShoppingList","books","hmtlBookList","book","pageData","renderShoppingListPage","buttonClickHandler","removeBookFromList","localStorageBooks","getBooksPerPage","getTotalPages","createBooksListsPerPage","renderPaginationButtons","makeActiveButton","e","clickedElement","pageButton","bookId","totalBooks","booksPerPage","totalPages","numbersButtonsList","pageNumber","currentPage","currentButton","booksPages","background"],"mappings":"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"}