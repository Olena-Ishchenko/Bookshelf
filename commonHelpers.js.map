{"version":3,"file":"commonHelpers.js","sources":["../src/js/shoppinglist.js","../src/js/support.js"],"sourcesContent":["import { hideLoader, showLoader } from '../card';\nimport { renderTitle } from '../js/Services/helpers';\nimport localStorageBooks from '../js/localstorage';\n\nconst shoppingList = document.querySelector('.cart-list');\nconst cartEmptyMsg = document.querySelector('.cart-empty-container');\nconst paginationList = document.querySelector('.pagination-list');\n\nrenderTitle('.shoppinglist-title', 'Shopping List');\nfunction renderShoppingList(books) {\n  shoppingList.innerHTML = '';\n  const hmtlBookList = books\n    .map(book => {\n      return `<li class=\"cart-item\">\n      <img\n        class=\"cart-item-img\"\n        src=\"${book.book_image}\"\n        alt=\"book image\"\n        width=\"100\"\n        height=\"142\"\n      />\n      <div class=\"cart-item-content\">\n        <div class=\"cart-item-content-top\">\n          <div class=\"cart-item-content-top-left\">\n            <h3 class=\"cart-item-title\">${book.title}</h3>\n            <p class=\"cart-item-category\">${book.list_name}</p>\n          </div>\n          <button data-id=\"${book._id}\" class=\"cart-item-del-button\">\n            <svg class=\"cart-item-del-button-icon\" width=\"12\" height=\"12\">\n              <use href=\"../img/symbol-defs.svg#icon-delete-shoppinglist-tab\" />\n            </svg>\n          </button>\n        </div>\n        <div class=\"cart-item-content-middle\">\n          <p class=\"cart-item-content-desc\">\n            ${book.description}\n          </p>\n          <div class=\"cart-item-content-bottom\">\n            <p class=\"cart-item-author\">${book.author}</p>\n            <div class=\"cart-items-links\">\n              <a\n                class=\"cart-items-link\"\n                target=\"_blank\"\n                href=\"${book.amazon_buy_link}\"\n              >\n                <svg class=\"cart-item-amazon\" width=\"32\" height=\"11\">\n                  <use href=\"../img/symbol-defs.svg#icon-amazon\" />\n                </svg>\n              </a>\n              <a\n                class=\"cart-items-link\"\n                target=\"_blank\"\n                href=\"${book.apple_buy_link}\"\n              >\n                <svg class=\"cart-items-apple\" width=\"16\" height=\"16\">\n                  <use href=\"../img/symbol-defs.svg#icon-applebook\" />\n                </svg>\n              </a>\n            </div>\n          </div>\n        </div>\n      </div>\n    </li>`;\n    })\n    .join('');\n  shoppingList.insertAdjacentHTML('beforeend', hmtlBookList);\n}\n\n\nlet pageData = {\n  books: [],\n  currentPage: 0,\n  nextPage: 0,\n  prevPage: 0,\n  totalBooks: 0,\n  totalPages: 0,\n  booksPerPage: 0,\n  buttonsPerPage: 0,\n  totalButtonsGroups: 0,\n  pagesOnLastGroup: 0,\n};\n\n\nfunction renderShoppingListPage(pageData) {\n  paginationList.removeEventListener('click', buttonClickHandler);\n  shoppingList.removeEventListener('click', removeBookFromList);\n  const books = localStorageBooks.getAllBooks();\n  shoppingList.innerHTML = '';\n  paginationList.innerHTML = '';\n  pageData.totalBooks = books.length;\n  pageData.booksPerPage = getBooksPerPage();\n  pageData.totalPages = getTotalPages(\n    pageData.totalBooks,\n    pageData.booksPerPage\n  );\n  pageData.books = createBooksListsPerPage(\n    books,\n    pageData.booksPerPage,\n    pageData.totalPages\n  );\n  pageData.buttonsPerPage = getButtonsPerPage();\n  pageData.totalButtonsGroups = Math.ceil(\n    pageData.totalPages / pageData.buttonsPerPage\n  );\n\n\n  pageData.pagesOnLastGroup = pageData.totalPages % pageData.totalButtonsGroups;\n\n  // console.log(pageData);\n  if (pageData.totalBooks > 0) {\n    if (pageData.totalPages === 1) {\n      renderShoppingList(pageData.books[0]);\n    }\n\n    if (pageData.totalPages > 1) {\n      renderShoppingList(pageData.books[pageData.currentPage]);\n      renderPaginationButtons(pageData, paginationList);\n      makeActiveButton(pageData.currentPage);\n      paginationList.addEventListener('click', buttonClickHandler);\n    }\n    shoppingList.addEventListener('click', removeBookFromList);\n\n  } else {\n    cartEmptyMsg.classList.remove('is-hidden');\n  }\n}\n\nfunction renderPaginationButtons(pageData, paginationList) {\n  paginationList.innerHTML = '';\n\n  if (pageData.totalPages > 1) {\n    paginationList.insertAdjacentHTML(\n      'beforeend',\n      `<button class=\"pagination-buttons-first\"><<</button>\n      <button class=\"pagination-buttons-prev\"><</button>\n      <button class=\"pagination-buttons-next\">></button>\n      <button class=\"pagination-buttons-last\">>></button>`\n    );\n\n    const prevButton = document.querySelector('.pagination-buttons-prev');\n    prevButton.insertAdjacentHTML(\n      'afterend',\n      '<ul class=\"pagination-buttons-numbers\"></ul>'\n    );\n\n    const numbersButtonsList = document.querySelector(\n      '.pagination-buttons-numbers'\n    );\n\n    const currentGroup =\n      parseInt(pageData.currentPage) / parseInt(pageData.buttonsPerPage);\n    // console.log(currentGroup);\n    // const totalGroups = Math.ceil(\n    //   pageData.totalPages / pageData.buttonsPerGroup\n    // );\n\n    // const bookOnLastPage =\n    //   parseInt(pageData.totalBooks) % parseInt(pageData.buttonsPerGroup);\n\n    // let lastButtonOfGroup = 0;\n    // lastButtonOfGroup =\n    //   parseInt(pageData.currentPage) + parseInt(pageData.buttonsPerGroup);\n    // const lastGroup = totalGroups - 1;\n    // if (lastGroup === currentGroup) {\n    //   console.log(lastButtonOfGroup);\n    //   console.log('last group');\n    // } else {\n    //   console.log('non last group');\n    // }\n\n    // // console.log('current group ', currentGroup, 'total groups', totalGroups);\n    // //parseInt(pageData.currentPage)\n    // //lastButtonOfGroup\n    for (let i = 0; i < pageData.totalPages; i++) {\n      numbersButtonsList.insertAdjacentHTML(\n        'beforeend',\n        `<li><button data-page=\"${i}\">${i + 1}</button></li>`\n      );\n    }\n\n    // const firstPageOfNextGroup =\n    //   Math.ceil(pageData.currentPage / pageData.buttonsPerGroup) +\n    //   pageData.buttonsPerGroup;\n    // if (totalGroups > 0) {\n    //   // console.log(totalGroups);\n    //   numbersButtonsList.insertAdjacentHTML(\n    //     'beforeend',\n    //     `<li><button data-group=\"${firstPageOfNextGroup}\">...</button></li>`\n    //   );\n    // }\n  }\n}\n\nfunction buttonClickHandler(e) {\n  const clickedElement = e.target.closest('button');\n  if (clickedElement) {\n    const pageButton = clickedElement.dataset.page;\n    // const groupButton = clickedElement.dataset.group;\n    if (pageButton) {\n      renderShoppingList(pageData.books[pageButton]);\n      makeActiveButton(pageButton);\n      pageData.currentPage = pageButton;\n    }\n    // if (groupButton) {\n    //   pageData.currentPage = groupButton;\n    //   console.log('primo pulsante dovrebbe diventare: ', pageData.currentPage);\n    //   renderPaginationButtons(pageData, paginationList);\n    //   renderShoppingList(pageData.books[groupButton]);\n    //   makeActiveButton(groupButton);\n    // }\n  }\n}\n\nfunction removeBookFromList(e) {\n  if (e.target.closest('.cart-item-del-button') !== null) {\n    const bookId = e.target.closest('.cart-item-del-button').dataset.id;\n    localStorageBooks.removeBookFromFavorites(bookId);\n    if (\n      parseInt(pageData.currentPage) === parseInt(pageData.totalPages) - 1 &&\n      pageData.books[pageData.currentPage].length === 1\n    ) {\n      if (pageData.currentPage >= 1) {\n        pageData.currentPage -= 1;\n      }\n    }\n    renderShoppingListPage(pageData);\n  }\n}\n\nfunction isMobile() {\n  const windowWidth = window.innerWidth;\n  return windowWidth < 767;\n}\n\nfunction getBooksPerPage() {\n  return isMobile() ? 4 : 3;\n}\n\nfunction getButtonsPerPage() {\n  return isMobile() ? 2 : 3;\n}\n\nfunction getTotalPages(totalBooks, booksPerPage) {\n  return Math.ceil(totalBooks / booksPerPage);\n}\n\n//   1      2     3\n//  1 2    3 4   4 5          5\n//\n//\n//\n\n// function buttonsHandler(e) {\n//   if (e.target.closest('button')) {\n//     if (e.target.closest('button').dataset.page) {\n//       console.log(e.target.closest('button').dataset.page);\n//       let newCurrentPage = e.target.closest('button').dataset.page;\n//       let currentButton = document.querySelector('.active');\n//       if (currentButton !== null) {\n//         currentButton.classList.remove('active');\n//       }\n//       makeActiveButton(newCurrentPage);\n//       currentButton = document.querySelector('.active');\n//       console.log(currentButton);\n//       renderShoppingList(pagesBook[newCurrentPage - 1]);\n//     }\n//     // if (\n//     //   e.target\n//     //     .closest('button')\n//     //     .classList.contains('pagination-buttons-prev')\n//     // ) {\n//     //   const currentButton = document.querySelector('.active');\n//     //   if (currentButton !== null) {\n//     //     const currentPage = currentButton.dataset.page;\n//     //     console.log('pressed button prev, current page: ', currentPage);\n//     //     if (currentPage > 1) {\n//     //       renderShoppingList(books[currentPage - 2]);\n//     //       currentButton.classList.remove('active');\n//     //       console.log('prev', currentButton, books);\n//     //       makeActiveButton(parseInt(currentPage) - 1);\n//     //     }\n//     //   }\n//     // }\n//     // if (\n//     //   e.target\n//     //     .closest('button')\n//     //     .classList.contains('pagination-buttons-next')\n//     // ) {\n//     //   const currentButton = document.querySelector('.active');\n//     //   if (currentButton !== null) {\n//     //     const currentPage = currentButton.dataset.page;\n//     //     console.log(currentPage);\n//     //     if (currentPage < books.length) {\n//     //       console.log('pressed button next, current page: ', currentPage);\n//     //       renderShoppingList(books[currentPage]);\n//     //       currentButton.classList.remove('active');\n//     //       console.log('next', currentButton, books);\n//     //       makeActiveButton(parseInt(currentPage) + 1);\n//     //     }\n//     //   }\n//     // }\n//   }\n// }\n\nfunction makeActiveButton(currentPage) {\n  const currentButton = document.querySelector('.active');\n  currentButton?.classList.remove('active');\n  const activeButton = document.querySelector(`[data-page=\"${currentPage}\"]`);\n  activeButton.classList.add('active');\n}\n\nfunction createBooksListsPerPage(books, booksPerPage, totalPages) {\n  let booksPages = [];\n  for (let i = 0; i < totalPages; i++) {\n    booksPages[i] = books.splice(0, booksPerPage);\n  }\n  return booksPages;\n}\n\n// for (let i = 0; i < 20; i++) {\n//   const book = {\n//     _id: `${i}`,\n//     title: `${i}`,\n//     author: 'Michelle Zauner',\n//     list_name: 'Paperback Nonfiction',\n//     book_image:\n//       'https://storage.googleapis.com/du-prd/books/images/9780525657743.jpg',\n//     description:\n//       'The daughter of a Korean mother and Jewish American father, and leader of the indie rock project Japanese Breakfast, describes creating her own identity after losing her mother to cancer.',\n//     amazon_buy_link: 'https://www.amazon.com/dp/0593379853?tag=NYTBSREV-20',\n//     apple_buy_link: 'https://goto.applebooks.apple/9781984896391?at=10lIEQ',\n//   };\n\n//   localStorageBooks.addBookToFavorites(book);\n// }\n\nrenderShoppingListPage(pageData);\n","// const sliderLine = document.querySelector('.slider-line');\n// const buttonScroll = document.querySelector('.slider-button-scroll');\n// const buttonArrow = document.querySelector('.slider-button-arrow');\n\n// let offset = 0;\n\n// buttonScroll.addEventListener('click', async () => {\n//     offset += 150;\n//     if (offset > 170) {\n//         offset = 0;\n//     }\n//     sliderLine.style.bottom = offset + 'px'\n        \n//     if (offset === 150) {\n//         buttonArrow.setAttribute('href', './img/symbol-defs.svg#icon-Vector-up1-1');\n//         } else {\n//         buttonArrow.setAttribute('href', './img/symbol-defs.svg#icon-Vector-down1-1');\n//         };\n// });\n\nconst sliderLine = document.querySelector('.slider-line'); \nconst buttonScrollDown = document.querySelector('.slider-button-scrolldown');\nconst buttonScrollUp = document.querySelector('.slider-button-scrollup');\n\nlet offset = 0;\n\nbuttonScrollDown.addEventListener('click', async () => { \n    offset += 150;\n    if (offset > 170) {\n        offset = 0;\n    }\n    sliderLine.style.bottom = offset + 'px'\n        \n    if (offset === 150) {\n        buttonScrollDown.classList.remove('scrolldown-open')\n        buttonScrollDown.classList.add('scrolldown-hidden');\n        buttonScrollUp.classList.remove('scrolldown-hidden');\n        buttonScrollUp.classList.add('scrolldown-open');\n    }\n});\n\nbuttonScrollUp.addEventListener('click', async () => { \n    offset += 150;\n    if (offset > 170) {\n        offset = 0;\n    }\n    sliderLine.style.bottom = offset + 'px'\n        \n    if (offset === 0) {\n        buttonScrollUp.classList.remove('scrolldown-open')\n        buttonScrollUp.classList.add('scrolldown-hidden');\n        buttonScrollDown.classList.remove('scrolldown-hidden');\n        buttonScrollDown.classList.add('scrolldown-open');\n    }\n});"],"names":["shoppingList","cartEmptyMsg","paginationList","renderTitle","renderShoppingList","books","hmtlBookList","book","pageData","renderShoppingListPage","buttonClickHandler","removeBookFromList","localStorageBooks","getBooksPerPage","getTotalPages","createBooksListsPerPage","getButtonsPerPage","renderPaginationButtons","makeActiveButton","numbersButtonsList","e","clickedElement","pageButton","bookId","isMobile","totalBooks","booksPerPage","currentPage","currentButton","totalPages","booksPages","sliderLine","buttonScrollDown","buttonScrollUp","offset"],"mappings":"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"}